EmberGraphs=Ember.Namespace.create({VERSION:"0.1.0"}),EmberGraphs.EmberGraphCaptionComponent=Ember.Component.extend(EmberGraphs.Core,{classNameBindings:["captionClass"],tagName:"figcaption",layout:Em.Handlebars.compile("{{text}}"),captionClass:function(){return this._class("caption")}.property()}),EmberGraphs.DataPairYComponent=Em.Component.extend(EmberGraphs.Core,{attributeBindings:["style"],classNameBindings:["yClass","waterfallClass"],tagName:"dd",layout:Ember.Handlebars.compile("{{point}}"),yClass:function(){return this._class("y")}.property(),waterfallClass:function(){var e=this.get("graphComponent.waterfallGraph"),t=this.get("point");return e&&t&&-1!==t.toString().indexOf("%")?this._class(parseFloat(t)>0?"positive":"negative"):!1}.property("point","graphComponent.waterfallGraph"),style:function(){var e=this.get("width"),t=this.get("height"),r=this._cssRule("height",t),a=this._cssRule("width",e),n=this.get("contentIndex"),i=n*parseFloat(e),s=this._cssRule("left",i+"%");return r+a+s}.property("height","width","contentIndex")}),EmberGraphs.EmberGraphComponent=Em.Component.extend(EmberGraphs.Core,EmberGraphs.Init,{prefix:"eg",fromZero:!1,caption:null,type:"bar",tickDistanceTarget:50,tagName:"figure",classNameBindings:["graphClass"],layout:Em.Handlebars.compile("{{view EmberGraphs.SeriesView content=view.parsedData}}{{#if caption}}{{ember-graph-caption text=caption}}{{/if}}"),height:null,width:null,graphClass:function(){var e=this.get("type");return this._class("graph-"+e)}.property(),lineGraph:function(){return"line"===this.get("type")}.property("type"),waterfallGraph:function(){return"waterfall"===this.get("type")}.property("type"),heightObserver:function(){var e=this,t=$(e.get("element")).height();e.set("height",t),$(e.get("element")).resize(function(){t=$(e.get("element")).height(),e.set("height",t)})}.on("didInsertElement"),widthObserver:function(){var e=this,t=$(e.get("element")).width();e.set("width",t),$(e.get("element")).resize(function(){t=$(e.get("element")).width(),e.set("width",t)})}.on("didInsertElement")}),Ember.Handlebars.helper("ember-graph-caption",EmberGraphs.EmberGraphCaptionComponent),Ember.Handlebars.helper("data-pair-y",EmberGraphs.DataPairYComponent),Em.Handlebars.helper("ember-graph",EmberGraphs.EmberGraphComponent),EmberGraphs.Core=Em.Mixin.create({graphComponent:function(){this.nearestOfType(EmberGraphs.EmberGraphComponent);return this.nearestOfType(EmberGraphs.EmberGraphComponent)}.property(),_class:function(e){var t=this.get("graphComponent.prefix")||this.get("prefix");return t+"-"+e},_twoDp:function(e){return Math.round(100*e)/100},_cssRule:function(e,t){var r=Modernizr.prefixed(e);return e=r?r.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"):e,e+":"+t+";"}}),EmberGraphs.Init=Em.Mixin.create({parsedData:function(){var e=this.get("series.data"),t=this.get("type"),r=this.get("dataParsingMethods")[t];return r?r(this,e):e}.property("series.data","type"),xValues:function(){var e=this.get("series.data"),t=[];return e.forEach(function(e){t.push(e.x)}),t}.property("series.data").readOnly(),yValues:function(){var e=this.get("series.data"),t=[];return e.forEach(function(e){t.push(e.y)}),t}.property("series.data").readOnly(),min:function(){var e=(this.get("series.data"),this.get("yValues")),t=this.get("fromZero"),r=t?0:Math.min.apply(Math,e);return r}.property("series.data").readOnly(),max:function(){var e=(this.get("series.data"),this.get("yValues")),t=Math.max.apply(Math,e);return t}.property("series.data").readOnly(),dataParsingMethods:{waterfall:function(e,t){var r=[],a=[],n=e.get("xValues"),i=e.get("yValues");i.forEach(function(e,t,r){var i=t+1,s=n[t],h=n[i],p=s+" to "+h,o=r[i],l=(o-e)/e*100;isNaN(l)||(l=Math.round(l)+"%",a.push({x:p,y:l}))});for(var s=0;s<t.length;s++)r.push(t[s]),r.push(a[s]);return r}}}),EmberGraphs.Line=Em.Mixin.create({lineStyle:null,lineProperties:function(){var e=this,t=(this.get("graphComponent.lineGraph"),this.get("graphComponent.yValues")),r=this.get("contentIndex"),a=this.get("graphComponent.min"),n=this.get("graphComponent.max"),i=this.get("content.y"),s=t[r+1],h=i-s,p=Math.abs(h)/(n-a)*100,o=(n-i)/(n-a)*100;Em.run.schedule("afterRender",this,function(){var t,r=$(this.get("element")).width(),a=$(this.get("graphComponent.element")).height(),n=p/100*a,i=Math.atan(r/n),s=r/Math.sin(i)/a*100;t=0>h?"matrix(1, 0, 0, -1, 0, 0) rotate(-"+i+"rad)":"rotate(-"+i+"rad)";var l=this._cssRule("height",s+"%"),m=this._cssRule("top",o+"%"),g=this._cssRule("transform",t);e.set("lineStyle",l+m+g)})}.on("didInsertElement").observes("graphComponent.lineGraph","graphComponent.width","graphComponent.height"),lineClass:function(){return this._class("line")}.property()}),EmberGraphs.DataPairView=Em.View.extend(EmberGraphs.Core,EmberGraphs.Line,{attributeBindings:["style"],classNameBindings:["xClass"],tagName:"dt",layout:Em.Handlebars.compile("{{yield}}{{data-pair-y point=view.content.y height=view.height width=view.width contentIndex=view.contentIndex}}"),template:Em.Handlebars.compile("<span {{bind-attr class='view.xTickClass'}}>{{view.content.x}}</span>{{#if lineGraph}}<div {{bind-attr class='view.lineClass' style='view.lineStyle'}}></div>{{/if}}"),xClass:function(){return this._class("x")}.property(),xTickClass:function(){return this._class("x-tick")}.property(),height:function(){var e,t=this.get("graphComponent.min"),r=this.get("graphComponent.max"),a=this.get("graphComponent.yValues"),n=this.get("graphComponent.waterfallGraph"),i=this.get("contentIndex")+1;if(n&&i%2===0){var s=i/2;e=a[s]}else e=this.get("content.y");var h=(e-t)/(r-t)*100;return Math.round(100*h)/100+"%"}.property("series.data"),width:function(){var e=(this.get("graphComponent.min"),this.get("graphComponent.max"),this.get("graphComponent.type")),t=this.get("graphComponent.parsedData"),r="line"===e?-1:0,a=100/(t.length+r);return Math.floor(100*a)/100+"%"}.property("graphComponent.parsedData"),style:function(){var e=this.get("height"),t=this.get("width"),r=this._cssRule("height",e),a=this._cssRule("width",t);return r+a}.property("height","width")}),EmberGraphs.SeriesView=Em.CollectionView.extend(EmberGraphs.Core,{attributeBindings:["style"],classNameBindings:["seriesClass"],tagName:"dl",itemViewClass:EmberGraphs.DataPairView,seriesClass:function(){return this._class("series")}.property(),style:function(){var e=this.get("graphComponent.tickDistanceTarget"),t=this.get("graphComponent.height"),r=Math.floor(t/e),a=t/r,n="1px "+a+"px",i=this._cssRule("background-size",n);return i}.property("graphComponent.tickDistanceTarget","graphComponent.min","graphComponent.max","graphComponent.height")});